@page
@model project_pharmacie.Areas.Staff.Pages.Suppliers.RateModel
@{
    ViewData["Title"] = "Noter fournisseur";
}

<div class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 py-6 space-y-6">

    <div class="flex items-start justify-between gap-4">
        <div>
            <h1 class="text-2xl font-semibold text-gray-900">Noter un fournisseur</h1>
            <p class="text-sm text-gray-600">Évaluation (mock) — prêt à brancher sur DB/service.</p>
        </div>

        <a href="/Staff/Suppliers"
           class="inline-flex items-center rounded-lg border border-gray-200 bg-white px-4 py-2 text-sm font-medium text-gray-900 hover:bg-gray-100">
            ← Retour
        </a>
    </div>


    @* Toast Success (TempData) *@
    @if (TempData["Toast.Success"] is string toast && !string.IsNullOrWhiteSpace(toast))
    {
        <div class="rounded-lg border border-emerald-200 bg-emerald-50 px-4 py-3 text-sm text-emerald-800">
            @toast
        </div>
    }
 
    @if (!string.IsNullOrWhiteSpace(Model.ErrorMessage))
    {
        <div class="rounded-lg border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-700">
            @Model.ErrorMessage
        </div>
    }

    @if (!Model.Found)
    {
        <div class="rounded-xl border border-gray-200 bg-white p-6 shadow-sm">
            <h2 class="text-base font-semibold text-gray-900">Fournisseur introuvable</h2>
            <p class="mt-1 text-sm text-gray-600">Aucun fournisseur ne correspond à l’identifiant fourni.</p>
            <div class="mt-4">
                <a href="/Staff/Suppliers"
                   class="inline-flex items-center rounded-lg bg-gray-900 px-4 py-2 text-sm font-medium text-white hover:bg-gray-800">
                    Retour à la liste
                </a>
            </div>
        </div>
    }
    else
    {
        <div class="rounded-xl border border-gray-200 bg-white p-6 shadow-sm space-y-4">
            <div>
                <p class="text-sm text-gray-500">Fournisseur</p>
                <p class="text-lg font-semibold text-gray-900">@Model.SupplierName</p>
                <p class="text-sm text-gray-600">
                    Note actuelle (mock) : <span class="font-medium">@Model.CurrentRating.ToString("N1")/5</span>
                    • @Model.CurrentRatingsCount avis
                </p>
            </div>

            <form method="post" class="space-y-5">
                <input type="hidden" asp-for="SupplierId" />

                <div>
                    <label class="block text-sm font-medium text-gray-700">Note (1 → 5)</label>
                    <input asp-for="Form.Rating" type="number" min="1" max="5" step="1"
                           class="mt-1 w-full rounded-lg border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500" />
                    <span asp-validation-for="Form.Rating" class="text-xs text-red-600"></span>
                    <p class="mt-1 text-xs text-gray-500">1 = mauvais, 5 = excellent.</p>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700">Commentaire (optionnel)</label>
                    <textarea asp-for="Form.Comment" rows="3"
                              placeholder="Ex: livraison rapide, bon packaging..."
                              class="mt-1 w-full rounded-lg border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500"></textarea>
                    <span asp-validation-for="Form.Comment" class="text-xs text-red-600"></span>
                </div>

                <div class="rounded-lg border border-amber-200 bg-amber-50 px-4 py-3 text-sm text-amber-800">
                    <strong>Confirmation :</strong> une fois envoyée, l’évaluation sera enregistrée (mock).
                </div>

                <div class="flex items-center justify-end gap-2 pt-2">
                    <a href="/Staff/Suppliers"
                       class="inline-flex items-center rounded-lg border border-gray-200 bg-white px-4 py-2 text-sm font-medium text-gray-900 hover:bg-gray-100">
                        Annuler
                    </a>

                    <button type="submit"
                            onclick="return confirm('Confirmer l’envoi de cette note ?');"
                            class="inline-flex items-center rounded-lg bg-emerald-600 px-4 py-2 text-sm font-medium text-white hover:bg-emerald-700">
                        Envoyer la note
                    </button>
                </div>
            </form>
        </div>
    }

</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}
